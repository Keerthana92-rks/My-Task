name: Send Workflow Status to EC2

on:
  workflow_run:
    workflows: ["Your Workflow Name Here"]
    types:
      - completed

jobs:
  send-status:
    runs-on: ubuntu-latest

    steps:
    - name: Get Workflow Status
      run: echo "Workflow Status: ${{ github.event.workflow_run.conclusion }}" >> workflow_status.txt

    - name: Send Workflow Status to EC2
      run: |
        echo "Sending Workflow Status to EC2..."
        status=$(cat workflow_status.txt)
        ec2_ip="3.84.90.146"
        github_token="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"
        curl -X POST \
          -H "Authorization: token ${github_token}" \
          -H "Content-Type: application/json" \
          -d '{"event_type": "workflow_status", "client_payload": {"status": "'"$status"'"}}' \
          "https://api.github.com/repos/YourUsername/YourRepo/dispatches"
        
        echo "Workflow Status sent to GitHub Dispatch Event."
